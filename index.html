<html>
<head>
    <title>Prediction of Poker Hands using the Machine Learning algorithm.</title>


</head>

<center><h1> Prediction of Poker Hands using the Machine Learning algorithm. <br/></h1>
    <h5>Ramprasad Narayanaswamy | Deepak Rohan Sekar (dsekar@uncc.edu) | Ganesh Ramamoorthy (gramamoo@uncc.edu)</h5>
</center>
<br/>

<h3> Introduction </h3>

<p>
    <strong>Context/ Motivation for the idea:</strong><br/>
    Playing a game of Poker is exciting. Once you get to know the poker rules, you are good to go. Why
    not predict the results of the game using machine learning algorithms. It possible to predict the game result
    of a poker without knowing the rules. The Machine Learning concept
    enables us to do the same. Machine learning involves the study and implementation of algorithms with the needed
    data in-hand. Such algorithms build a model from example inputs (input dataset) in order to make data-driven
    decisions
    to solve a problem instead of following strict program instructions.
    Again, a lot of machine learning algorithms are available. But, traditionally these algorithms are implemented based
    on a sequential approach. Given a large dataset, it makes sense to parallelize the data and process it in a
    distributed
    environment. The Map-Reduce paradigm allows us to do it. Certain common machine learning algorithms fit the
    Statistical
    Query Model, allowing us to write them in “summation forms” which makes them possible to be implemented using
    MapReduce
    paradigm. Thus, coding a Machine Learning algorithm using Hadoop paves way to learn both the concepts in-depth.
</p>

<p><strong>What we did?</strong><br/>
    We used the Poker Hands dataset from UCI Machine Learning Repository in a distributed environment to
    build a multi-class classifier using the Naive-Bayes classification algorithm and implement AdaBoost technique
    (forming k such classifiers with each subsequent classifier learning from the mistakes of its previous one) to
    improve its accuracy (the accuracy of Naive-Bayes is upto 70%). Then, each of the classifiers formed are used to
    predict the outcome/label of other incoming poker hands and their predictions are voted with a score and the
    prediction with a maximum score is considered to be the final prediction. The class which the maximum number of
    classifiers predict is considered to be accurate.</p>

<h3>Data Details</h3>
<strong>Dataset Used: </strong> <a href="http://archive.ics.uci.edu/ml/machine-learning-databases/poker/">
    Data Folder
</a></br>
The data consists of <strong>25010</strong> training data and <strong>1 million</strong> entries of test data.<br/>
The total number of variables are 11<br/>
<strong>Feature Attributes:</strong> 10<br/>
<strong>Class Attribute:</strong> 1<br/>

<p>
    <strong>Sample Data:</strong><br/>
    1,10,1,11,1,13,1,12,1,1,9<br/>
    2,11,2,13,2,10,2,12,2,1,9<br/>
    3,12,3,11,3,13,3,10,3,1,9<br/>
    4,10,4,11,4,1,4,13,4,12,9<br/>
    4,1,4,13,4,12,4,11,4,10,9<br/>
</p>

<p>
    <strong>Variables of Data:</strong><br/>
    1. S1 "Suit of card #1"<br/>
    Ordinal (1-4) representing [Hearts, Spades, Diamonds, Clubs]<br/>
    2. C1 "Rank of card #1"<br/>
    Numerical (1-13) representing (Ace, 2, 3, … , Queen, King)<br/>
    3. S2 "Suit of card #2"<br/>
    Ordinal (1-4) representing [Hearts, Spades, Diamonds, Clubs]<br/>
    4. C2 "Rank of card #2"<br/>
    Numerical (1-13) representing (Ace, 2, 3, ... , Queen, King)<br/>
    5. S3 "Suit of card #3"<br/>
    Ordinal (1-4) representing [Hearts, Spades, Diamonds, Clubs]<br/>
    6. C3 "Rank of card #3"<br/>
    Numerical (1-13) representing (Ace, 2, 3, ... , Queen, King)<br/>
    7. S4 "Suit of card #4"<br/>
    Ordinal (1-4) representing [Hearts, Spades, Diamonds, Clubs]<br/>
    8. C4 "Rank of card #4"<br/>
    Numerical (1-13) representing (Ace, 2, 3, ... , Queen, King)<br/>
    9. S5 "Suit of card #5"<br/>
    Ordinal (1-4) representing [Hearts, Spades, Diamonds, Clubs]<br/>
    10. C5 "Rank of card 5"<br/>
    Numerical (1-13) representing (Ace, 2, 3, ... , Queen, King)<br/>
    11. CLASS "Poker Hand"<br/>

<p>
    <strong>Ordinal (0-9)</strong><br/>
    0: Nothing in hand; not a recognized poker hand<br/>
    1: One pair; one pair of equal ranks within five cards<br/>
    2: Two pairs; two pairs of equal ranks within five cards<br/>
    3: Three of a kind; three equal ranks within five cards<br/>
    4: Straight; five cards, sequentially ranked with no gaps<br/>
    5: Flush; five cards with the same suit<br/>
    6: Full house; pair + different rank three of a kind<br/>
    7: Four of a kind; four equal ranks within five cards<br/>
    8: Straight flush; straight + flush<br/>
    9: Royal flush; {Ace, King, Queen, Jack, Ten} + flush<br/>
</p>
</p>
<p><strong>Class Distribution: </strong><br/>

    <strong>Training set: </strong><br/><br/>

    0: Nothing in hand, 12493 instances <br/>
    1: One pair, 10599 instances<br/>
    2: Two pairs, 1206 instances<br/>
    3: Three of a kind, 513 instances<br/>
    4: Straight, 93 instances<br/>
    5: Flush, 54 instances<br/>
    6: Full house, 36 instances<br/>
    7: Four of a kind, 6 instances<br/>
    8: Straight flush, 5 instances<br/>
    9: Royal flush, 5 instances<br/><br/>

    The Straight flush and Royal flush hands are not as representative of
    the true domain because they have been over-sampled. The Straight flush
    is 14.43 times more likely to occur in the training set, while the
    Royal flush is 129.82 times more likely.<br/><br/>

    Total of 25010 instances.<br/><br/>

    <strong>Testing set:</strong><br/><br/>

    0: Nothing in hand, 501209 instances<br/>
    1: One pair, 422498 instances<br/>
    2: Two pairs, 47622 instances<br/>
    3: Three of a kind, 21121 instances<br/>
    4: Straight, 3885 instances<br/>
    5: Flush, 1996 instances<br/>
    6: Full house, 1424 instances<br/>
    7: Four of a kind, 230 instances<br/>
    8: Straight flush, 12 instances<br/>
    9: Royal flush, 3 instances<br/><br/>

    Total of one million instances.</p>

<p>
    <strong>Algorithms Used:</strong><br/>
    1: Naive-Bayes classification algorithm <br/>
    2: AdaBoost Technique
</p>

<p>
    <strong>Platform:</strong>
    Hadoop MapReduce
</p>

<p>

<h3>Tasks:</h3>
1: As the Dataset is already identified, its attributes need to be understood to distinguish the data & class
attributes to be used in the implementation. <br/>
2: The Naive-Bayes multi-class classification algorithm is chosen.<br/>
3: The chosen classification algorithm is to be represented in a “summation form”.<br/>
4: Initial weights are assigned to each of the 25,010 records of training data.<br/>
5: Then, the 25,010 records of training data (along with weights assigned to each) is sampled and distributed
using the MapReduce paradigm.<br/>
6: The Mappers (no. of Mappers is based on split) perform the given summation/computations on their corresponding
data splits (partial training data) and send them to the reducer.<br/>
7: The reducer combines these partial summations to obtain the final prediction model.<br/>
8: This model is used on same dataset to perform predictions.<br/>
9: Based on these predictions, the error of the classifier is calculated and their weights are updated accordingly.<br/>
10: Then, the dataset, along with these new updated weights is sent to step 5 and the process goes on, until the error
is reduced considerably.<br/>
11: Then, these classifier models developed is used on the 1,000,000 records of test data to perform predictions and
to
quantify the performance of the system by calculating precision & recall.<br/>
12: The prediction of the class of the hand can be used to determine the winner of a game

</p>
<p>

<h3>Accomplished:</h3><
Given one or more input poker hand/s, our product will define the label for each of the input hands (Ex: Royal Flush,
Two-of-a-kind etc.) using the classifier models developed with the input training dataset. This method doesn't utilize
the
inbuilt rules, but in turn it uses the classifier model to predict the class based on the input dataset.<br/>
</p>
<strong>References:</strong><br/>
1. Data Mining, Concepts and Techniques - Third Edition by Jiawei Han, Micheline Kamber, Jian Pei, pages 350-355 &
380-382<br/>
2. https://en.wikipedia.org/wiki/List_of_poker_hands


</body>
</html>